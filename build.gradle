buildscript {
    ext {
        kotlin_version = '1.2.50'
        http4k_version = '3.31.0'
        kotlin_html_version = '0.1.4'
        config_version = '1.3.3'
    }

    repositories {
        jcenter()
        maven { url "https://plugins.gradle.org/m2/" }
    }

    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
        classpath "com.github.jengelman.gradle.plugins:shadow:2.0.4"
    }
}

apply plugin: "application"
mainClassName = "example.ApplicationKt"

apply plugin: "kotlin"
apply plugin: "com.github.johnrengelman.shadow"

repositories {
    jcenter()
}

dependencies {
    implementation files('libs/graalvm-1.0.0-rc2_svm.jar')
    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
    implementation "org.http4k:http4k-core:$http4k_version"
    implementation "org.http4k:http4k-server-netty:$http4k_version"
    implementation "com.typesafe:config:$config_version"
    implementation "org.celtric.kotlin:kotlin-html:$kotlin_html_version"
}

task dockerBuild(type: Exec) {
    executable "sh"
    args "-c", "docker build -t jar ."
}

dockerBuild.dependsOn(tasks.shadowJar)